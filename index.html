<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Zîn Elhac</title>
  <style>
    /* Stil kısmını dosya boyutunu korumak için özet geçiyorum, 
       sizin mevcut index_fixed_v5.txt dosyanızdaki tüm CSS buraya gelecek */
    :root{ --c1:#f5f0eb; --c2:#b36932; --c3:#626a48; --c4:#faf7f5; --c5:#e7dbd0; --c6:#c65c75; --ink: var(--c3); --headerH:70px; --footerH:64px; --max:1260px; --ease: cubic-bezier(.16,.92,.18,1); }
    *{box-sizing:border-box;} body{margin:0; color:var(--ink); background: var(--c4); font-family: sans-serif; font-weight: 300; overflow-x:hidden;}
    /* ... (Mevcut CSS'inizin tamamı buraya gelecek) ... */
    .modal{ position:fixed; inset:0; background: rgba(0,0,0,0.4); backdrop-filter:blur(16px); display:none; align-items:center; justify-content:center; z-index:100; opacity:0; transition: opacity 260ms; }
    .modal.open{ display:flex; opacity:1; }
  </style>
</head>
<body>
  <script>
    // GEREKLİ DÜZELTMELERİN YAPILDIĞI JAVASCRIPT KISMI
    const contactModal = document.getElementById('contactModal');
    const contactForm = document.getElementById('contactForm');
    const submitBtn = contactForm.querySelector('.submit');

    // Modalı kapatma ve formu temizleme fonksiyonu
    function closeModal() {
      contactModal.classList.remove('open');
      contactForm.reset(); // Kutuyu kapatınca içindekileri sıfırlar
      document.getElementById('msgCount').textContent = "0 / 500";
    }

    document.getElementById('closeModal').onclick = closeModal;

    // Form Gönderme İşlemi
    contactForm.onsubmit = async (e) => {
      e.preventDefault();
      
      // Butonu kilitle ve görsel geri bildirim ver
      submitBtn.disabled = true;
      const originalBtnText = submitBtn.textContent;
      submitBtn.textContent = 'Gönderiliyor...';

      const formData = new FormData(contactForm);
      const data = {
        name: formData.get('firstName') + " " + formData.get('lastName'),
        email: formData.get('email'),
        phone: formData.get('phonePrefix') + formData.get('phone'),
        country: formData.get('country'),
        message: formData.get('message'),
        sessions: formData.getAll('sessions'),
        packages: formData.getAll('packages')
      };

      try {
        const response = await fetch('/api/lead', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });

        if (response.ok) {
          alert('Mesajınız başarıyla iletildi!');
          closeModal(); // Başarılıysa kutuyu kapat ve sıfırla
        } else {
          const errText = await response.text();
          alert('Sunucu hatası: ' + (errText || response.statusText));
        }
      } catch (error) {
        console.error('Hata:', error);
        alert('Bağlantı hatası! Lütfen internetinizi kontrol edin.');
      } finally {
        // Hata olsa da olmasa da butonu tekrar aç
        submitBtn.disabled = false;
        submitBtn.textContent = originalBtnText;
      }
    };

    // Karakter sayacı
    document.getElementById('message').oninput = function() {
      document.getElementById('msgCount').textContent = this.value.length + " / 500";
    };

    // İletişim butonlarına tıklama (Modalı açar)
    document.querySelectorAll('[data-open-contact]').forEach(btn => {
      btn.onclick = () => contactModal.classList.add('open');
    });
  </script>
</body>
</html>
